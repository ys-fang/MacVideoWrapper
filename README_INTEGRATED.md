# 影片編輯器 v3 - 整合版本

## 🎯 概述

影片編輯器 v3 是整合了單次處理與批次處理功能的完整版本，提供兩種工作模式：

- **🎬 單次處理模式**：適合處理單一影片檔案
- **📦 批次處理模式**：適合大量處理多個影片檔案

## ✨ 新功能特色

### 🔄 雙模式支援
- **單次模式**：原有的完整功能，支援自訂開頭/結尾圖片、時長設定
- **批次模式**：新增的批次處理功能，自動匹配影片與圖片檔案

### 🎛️ 批次處理功能
- **智能檔案匹配**：自動匹配影片與圖片檔案
- **多種匹配策略**：完全檔名匹配 → 相似檔名匹配 → 順序匹配
- **批次預覽**：處理前可預覽所有匹配結果
- **統一設定**：批次模式固定使用相同圖片作為開頭結尾，固定3秒

### 🖥️ 整合介面
- **標籤頁設計**：清晰分離兩種模式
- **共用工作佇列**：兩種模式共用同一個處理佇列
- **統一進度追蹤**：實時顯示處理進度
- **流暢操作體驗**：移除不必要的確認對話窗，操作更順暢

## 🚀 使用方式

### 啟動應用程式
```bash
python3 video_wrapper2.py
```

### 單次處理模式
1. 切換到「🎬 單次處理」標籤頁
2. 選擇影片檔案
3. 選擇開頭/結尾圖片
4. 設定顯示時長
5. 點擊「➕ 加入處理佇列」

### 批次處理模式
1. 切換到「📦 批次處理」標籤頁
2. 選擇影片資料夾
3. 選擇圖片資料夾
4. 選擇輸出資料夾
5. 點擊「🔍 掃描檔案」
6. 確認匹配結果
7. 點擊「🚀 開始批次處理」

## 📁 檔案匹配策略

### 批次模式的檔案匹配順序
1. **完全檔名匹配**：優先匹配檔名完全相同的檔案
2. **相似檔名匹配**：匹配檔名相似的檔案（相似度 > 50%）
3. **順序匹配**：按檔名排序進行順序匹配

### 支援格式
- **影片格式**：MP4, MOV, MKV, AVI, M4V
- **圖片格式**：PNG, JPG, JPEG, BMP, GIF, TIFF

## 🛠️ 技術架構

### 核心類別
- `FileMatcher`：檔案匹配引擎
- `BatchManager`：批次狀態管理
- `BatchJobItem`：批次工作項目
- `BatchPreviewWidget`：批次預覽元件
- `BatchSettingsPanel`：批次設定面板

### 處理流程
1. **檔案掃描** → 掃描支援格式的檔案
2. **智能匹配** → 使用多種策略匹配檔案
3. **批次建立** → 建立批次工作群組
4. **佇列處理** → 依序處理每個工作
5. **進度追蹤** → 即時更新處理狀態

## 📦 打包為獨立應用程式

### 使用整合版本打包
```bash
python3 build_video_wrapper2_mac.py
```

### 打包特色
- 應用程式名稱：VideoWrapper2
- 單一 .app 檔案包含兩種模式
- 內嵌 FFmpeg/FFprobe
- 完整的圖形化介面
- 無需額外依賴

## 🔧 開發與測試

### 運行測試
```bash
# 快速測試（推薦）
python3 test_quick.py

# 完整測試
python3 test_integrated_app.py
```

### 測試內容
- 導入功能測試
- 檔案匹配功能測試
- 批次管理器測試
- UI元件測試

## 📋 版本比較

| 功能 | v2 (單次模式) | v3 (整合版) |
|------|---------------|-------------|
| 單次處理 | ✅ | ✅ |
| 批次處理 | ❌ | ✅ |
| 檔案匹配 | ❌ | ✅ |
| 批次預覽 | ❌ | ✅ |
| 標籤頁介面 | ❌ | ✅ |
| 共用佇列 | ❌ | ✅ |

## 🎉 使用建議

### 何時使用單次模式
- 處理單一影片檔案
- 需要自訂開頭/結尾圖片
- 需要調整顯示時長
- 需要精確控制處理參數

### 何時使用批次模式
- 處理多個影片檔案
- 影片與圖片檔名有對應關係
- 需要統一的開頭結尾設定
- 希望自動化處理流程
- 追求流暢的操作體驗（無確認對話窗干擾）

## 🔮 未來規劃

### 第二階段功能
- 批次進度條和統計資訊
- 批次錯誤處理與恢復機制
- 批次設定儲存/載入功能
- 批次處理結果匯總

### 第三階段功能
- 進階匹配規則（AI 智能匹配）
- 批次處理統計報表
- 效能優化（並行處理控制）
- 批次模板功能

## 📄 授權

本專案採用 MIT 授權，詳見 [LICENSE](LICENSE) 檔案。

## 🙌 貢獻

歡迎提交 Issue 和 Pull Request 來改善整合版本功能。

---

*影片編輯器 v3 - 整合版本，讓影片處理更簡單、更高效！*
