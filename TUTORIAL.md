# 🎬 影片編輯器 v3 使用教學

## 📋 目錄
- [快速開始](#快速開始)
- [雙模式介紹](#雙模式介紹)
- [單次處理模式](#單次處理模式)
- [批次處理模式](#批次處理模式)
- [拖曳功能詳解](#拖曳功能詳解)
- [進階功能](#進階功能)
- [疑難排解](#疑難排解)
- [常見問題](#常見問題)

---

## 🚀 快速開始

### 系統需求
- **作業系統**：macOS 12 或更高版本
- **硬體**：Apple Silicon (M1/M2/M3) 或 Intel Mac
- **記憶體**：建議 8GB 以上
- **儲存空間**：至少 1GB 可用空間

### 首次啟動
1. 雙擊 `VideoWrapper2.app` 啟動應用程式
2. 如果 macOS 顯示安全警告，請：
   - 前往「系統偏好設定」→「安全性與隱私」
   - 點擊「仍要開啟」允許執行

---

## 🎯 雙模式介紹

影片編輯器 v3 提供兩種處理模式，滿足不同的使用需求：

### 🎬 單次處理模式
- **適用場景**：處理單一影片檔案
- **特色功能**：自訂開頭/結尾圖片、調整顯示時長
- **操作方式**：手動選擇檔案和設定參數

### 📦 批次處理模式
- **適用場景**：大量處理多個影片檔案
- **特色功能**：智能檔案匹配、自動化處理
- **操作方式**：選擇資料夾，系統自動匹配檔案

### 🔄 模式切換
- 使用頂部的標籤頁切換兩種模式
- 兩種模式共用同一個處理佇列
- 可以同時使用兩種模式處理不同檔案

---

## 🎬 單次處理模式

### 方法一：傳統檔案選擇
1. **選擇影片檔案**
   - 點擊「📹 影片檔案」區塊中的「選擇影片」按鈕
   - 在檔案選擇器中瀏覽並選擇您的影片檔案
   - 支援格式：MP4、MOV、MKV、AVI

2. **選擇圖片檔案**
   - **開頭圖片**：點擊「選擇開頭圖片」按鈕
   - **結尾圖片**：點擊「選擇結尾圖片」按鈕
   - 支援格式：PNG、JPG、JPEG、BMP、GIF

3. **設定顯示時長**
   - 在圖片選擇區塊中調整「開頭」和「結尾」的秒數
   - 預設值：3.0 秒
   - 可調整範圍：0.1 - 30.0 秒

### 方法二：✨ 拖曳檔案（推薦）

#### 🎬 拖曳影片檔案
1. **從 Finder 拖曳**
   - 開啟 Finder，找到您的影片檔案
   - 直接拖曳影片檔案到應用程式視窗的拖放區
   - 支援多個影片檔案同時拖曳

2. **從其他應用程式拖曳**
   - 從 QuickTime Player 拖曳
   - 從 Photos 應用程式拖曳
   - 從任何支援檔案拖曳的應用程式

#### 🖼️ 拖曳圖片檔案
1. **單一圖片拖曳**
   - 拖曳圖片到拖放區，會自動設為開頭圖片
   - 如果已有開頭圖片，會設為結尾圖片

2. **多個圖片拖曳**
   - 同時拖曳多個圖片檔案
   - 第一個圖片會設為開頭圖片
   - 第二個圖片會設為結尾圖片

3. **從預覽應用程式拖曳**
   - 從「預覽」應用程式拖曳圖片
   - 從「照片」應用程式拖曳圖片
   - 從網頁瀏覽器拖曳圖片（如果已下載）

---

## 📦 批次處理模式

### 🎯 批次處理流程

1. **選擇資料夾**
   - **影片資料夾**：包含要處理的影片檔案
   - **圖片資料夾**：包含對應的圖片檔案
   - **輸出資料夾**：處理後的檔案儲存位置

2. **掃描檔案**
   - 點擊「🔍 掃描檔案」按鈕
   - 系統自動匹配影片和圖片檔案
   - 在預覽表格中查看匹配結果

3. **開始處理**
   - 確認匹配結果無誤後，點擊「🚀 開始批次處理」
   - 系統自動將所有工作加入處理佇列
   - 在右側工作列表中查看處理進度

### 📋 檔案匹配規則

系統會按照以下順序進行檔案匹配：

1. **完全檔名匹配**：優先匹配檔名完全相同的檔案
   - 例如：`video1.mp4` 匹配 `video1.png`

2. **相似檔名匹配**：匹配檔名相似的檔案（相似度 > 50%）
   - 例如：`video_001.mp4` 匹配 `video001.png`

3. **順序匹配**：按檔名排序進行順序匹配
   - 例如：第一個影片匹配第一個圖片

### 🎛️ 批次處理設定

- **固定時長**：批次模式固定使用 3 秒作為開頭和結尾時長
- **同圖設定**：批次模式固定使用相同圖片作為開頭和結尾
- **統一輸出**：所有處理後的檔案都會儲存在指定的輸出資料夾

### 📊 批次預覽功能

- **即時預覽**：掃描後立即顯示所有匹配結果
- **檔案資訊**：顯示影片檔案、圖片檔案、輸出檔案名稱
- **統計資訊**：顯示找到的檔案配對數量

---

## 🎨 拖曳功能詳解

### 📁 拖放區特色
- **視覺回饋**：拖曳檔案時，拖放區會變色提示
- **格式檢查**：自動過濾支援的檔案格式
- **錯誤提示**：不支援的檔案會顯示警告

### 🔄 拖曳順序邏輯
```
影片檔案 → 設為主要影片
第一個圖片 → 設為開頭圖片
第二個圖片 → 設為結尾圖片
```

### ⚡ 快速操作技巧
1. **一次拖曳多個檔案**
   - 按住 Cmd 鍵選擇多個檔案
   - 一次拖曳到應用程式

2. **快速切換圖片**
   - 直接拖曳新圖片覆蓋舊圖片
   - 自動更新檔案路徑

3. **清除選擇**
   - 點擊「🗑️ 清除」按鈕
   - 或重新拖曳檔案覆蓋

---

## ⚙️ 進階功能

### 🎛️ 處理選項
1. **🚀 免重編碼優先**
   - 預設啟用
   - 嘗試不重新編碼主影片，保持原始品質
   - 如果失敗會自動回退到重編碼模式

2. **⚡ 硬體加速編碼**
   - 預設啟用
   - 使用 Mac 的 VideoToolbox 硬體編碼
   - 大幅提升處理速度

3. **📁 自動輸出到來源資料夾**
   - 預設啟用
   - 處理後的檔案會儲存在原影片的同一資料夾
   - 檔名格式：`processed_原檔名.mp4`

### 🖼️ 圖片選項
1. **✨ 開頭與結尾使用相同圖片**
   - 勾選此選項後，結尾圖片會自動使用開頭圖片
   - 結尾圖片選擇按鈕會被禁用
   - 適合製作對稱的開頭結尾

2. **⏱️ 自訂顯示時長**
   - 開頭和結尾可以設定不同的顯示時長
   - 精確到 0.1 秒

### 📊 預覽功能
1. **🖼️ 預覽圖片**
   - 點擊「顯示預覽」勾選框
   - 使用預覽按鈕查看開頭、結尾圖片
   - 預覽影片第一幀

2. **📋 檔案資訊**
   - 自動顯示影片解析度、幀率、編碼格式
   - 顯示音訊資訊
   - 顯示圖片檔案名稱

---

## 🔄 序列處理

### 📋 工作佇列
1. **加入佇列**
   - 設定完成後，點擊「➕ 加入處理佇列」
   - 工作會加入右側的處理列表

2. **佇列管理**
   - 查看進行中的工作數量
   - 查看等待中的工作數量
   - 可以取消正在進行的工作

3. **完成通知**
   - 工作完成後會顯示綠色勾號
   - 可以點擊「開啟位置」查看輸出檔案

### 🎯 批次處理
1. **多個影片處理**
   - 可以連續加入多個影片到佇列
   - 系統會依序處理，避免資源競爭

2. **不同設定**
   - 每個工作可以使用不同的圖片和設定
   - 靈活處理不同需求

---

## 🛠️ 疑難排解

### ❌ 常見錯誤
1. **「檔案已毀損」錯誤**
   ```bash
   xattr -cr /path/to/影片編輯器_v2.app
   ```

2. **無法啟動應用程式**
   - 檢查 macOS 版本是否支援
   - 確認有足夠的磁碟空間

3. **拖曳檔案無反應**
   - 確認檔案格式是否支援
   - 檢查檔案是否損壞
   - 嘗試重新啟動應用程式

### 🔧 效能優化
1. **處理速度慢**
   - 確保啟用「硬體加速編碼」
   - 關閉其他佔用 CPU 的應用程式
   - 檢查磁碟空間是否充足

2. **記憶體不足**
   - 關閉其他應用程式
   - 重新啟動應用程式
   - 一次處理較少的檔案

---

## ❓ 常見問題

### Q: 支援哪些影片格式？
**A:** 支援 MP4、MOV、MKV、AVI 等常見格式。建議使用 MP4 格式以獲得最佳相容性。

### Q: 支援哪些圖片格式？
**A:** 支援 PNG、JPG、JPEG、BMP、GIF 格式。建議使用 PNG 或 JPG 格式。

### Q: 可以同時處理多個影片嗎？
**A:** 可以！使用序列處理功能，將多個影片加入佇列，系統會依序處理。

### Q: 處理後的檔案會覆蓋原檔案嗎？
**A:** 不會！處理後的檔案會以 `processed_` 開頭命名，原檔案保持不變。

### Q: 可以只加開頭或只加結尾嗎？
**A:** 可以！只選擇開頭圖片或只選擇結尾圖片即可。

### Q: 拖曳功能支援從哪裡拖曳？
**A:** 支援從 Finder、QuickTime Player、Photos、預覽應用程式、網頁瀏覽器（已下載檔案）等拖曳。

### Q: 應用程式會記住我的設定嗎？
**A:** 目前不會，每次啟動都會重置設定。建議保存常用的圖片檔案以便快速使用。

### Q: 處理失敗怎麼辦？
**A:** 檢查錯誤訊息，常見原因包括檔案損壞、磁碟空間不足、或檔案格式不支援。

### Q: 單次模式和批次模式有什麼區別？
**A:** 
- **單次模式**：適合處理單一影片，可以自訂開頭/結尾圖片和時長
- **批次模式**：適合大量處理，系統自動匹配檔案，固定使用相同圖片和3秒時長

### Q: 批次模式的檔案匹配準確嗎？
**A:** 系統會按照完全匹配 → 相似匹配 → 順序匹配的順序進行，建議檔案命名有規律以提高匹配準確性。

### Q: 可以同時使用兩種模式嗎？
**A:** 可以！兩種模式共用同一個處理佇列，可以同時處理不同類型的檔案。

### Q: 批次處理時可以自訂時長嗎？
**A:** 批次模式為了簡化操作，固定使用3秒時長。如需自訂時長，請使用單次模式。

---

## 🎉 使用技巧

### 💡 效率提升
1. **準備常用圖片**：將常用的開頭結尾圖片放在容易找到的位置
2. **使用拖曳功能**：比點擊按鈕選擇檔案更快速
3. **批次處理**：一次加入多個影片到佇列
4. **硬體加速**：確保啟用以獲得最佳效能

### 🎨 創意應用
1. **品牌宣傳**：為影片添加公司 Logo 開頭
2. **個人化**：添加個人簽名或標誌
3. **系列影片**：為系列影片添加統一的開頭結尾
4. **教學影片**：添加課程資訊或聯絡方式

---

## 📞 技術支援

如果您在使用過程中遇到問題，請：
1. 檢查本教學文件的疑難排解部分
2. 查看應用程式內的錯誤訊息
3. 確認系統需求和檔案格式
4. 重新啟動應用程式嘗試

---

*最後更新：2024年12月*
